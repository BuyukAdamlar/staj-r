@page "/add_std"

<!-- Layout wrapper -->
    <div class="layout-wrapper layout-content-navbar">
      <div class="layout-container">
        <!-- Menu -->
        <aside id="layout-menu" class="layout-menu menu-vertical menu bg-menu-theme">
            <div class="app-brand demo">
                <a href=/dashboard class="app-brand-link">
                    <span class="app-brand-logo demo">
                        <img src="../dash/assets/img/icons/brands/logo1.png" alt class="staj-r_logo" width="50" height="50" />
                    </span>
                    <span class="app-brand-text demo menu-text fw-bolder ms-2" style="color:black">Staj-R</span>
                </a>

                <a href="javascript:void(0);" class="layout-menu-toggle menu-link text-large ms-auto d-block d-xl-none">
                    <i class="bx bx-chevron-left bx-sm align-middle"></i>
                </a>
            </div>

            <div class="menu-inner-shadow"></div>

            <ul class="menu-inner py-1">

                <li class="menu-item">
                    <a href=/dashboard class="menu-link">
                        <i class="menu-icon tf-icons bx bx-home-circle"></i>
                        <div data-i18n="Analytics">Dashboard</div>
                    </a>
                </li>

                <li class="menu-item">
                    <a href=/users class="menu-link"
                       <i class="menu-icon tf-icons bx bx-dock-top"></i>
                       <div data-i18n="Kullanıcılar">Kullanıcılar</div>
                    </a>
                </li>

                <li class="menu-item active open">
                    <a href=/add_std class="menu-link menu-toggle">
                        <i class="menu-icon tf-icons bx bx-dock-top"></i>
                        <div data-i18n="Kullanıcı Ekle">Kullanıcı Ekle</div>
                    </a>
                    <ul class="menu-sub">
                        <li class="menu-item active">
                            <a href=/add_std class="menu-link">
                                <div data-i18n="Öğrenci Ekle">Öğrenci Ekle</div>
                            </a>
                        </li>

                        <li class="menu-item">
                            <a href=/add_academic class="menu-link">
                                <div data-i18n="Öğretim Görevlisi Ekle">Öğretim Görevlisi Ekle</div>
                            </a>
                        </li>

                        <li class="menu-item">
                            <a href=/add_councilor class="menu-link">
                                <div data-i18n="Kurul Üyesi Ekle">Kurul Üyesi Ekle</div>
                            </a>
                        </li>

                        <li class="menu-item">
                            <a href=/add_dpthead class="menu-link">
                                <div data-i18n="Bölüm Sorumlusu Ekle">Bölüm Sorumlusu Ekle</div>
                            </a>
                        </li>

                        <li class="menu-item">
                            <a href=/diger class="menu-link">
                                <div data-i18n="Diğer">Diğer</div>
                            </a>
                        </li>
                    </ul>
                </li>
                <li class="menu-item">
                    <a href=/add_role class="menu-link"
                       <i class="menu-icon tf-icons bx bx-dock-top"></i>
                       <div data-i18n="Yeni Rol Ekle">Yeni Rol Ekle</div>
                    </a>
                </li>
            </ul>
        </aside>
        <!-- / Menu -->

        <!-- Layout container -->
        <div class="layout-page">
          <!-- Navbar -->
          <nav
            class="layout-navbar container-xxl navbar navbar-expand-xl navbar-atached align-items-center bg-navbar-theme"
            id="layout-navbar"
          >
            <div class="layout-menu-toggle navbar-nav align-items-xl-center me-3 me-xl-0 d-xl-none">
              <a class="nav-item nav-link px-0 me-xl-4" href="javascript:void(0)">
                <i class="bx bx-menu bx-sm"></i>
              </a>
            </div>

            <div class="navbar-nav-right d-flex align-items-center" id="navbar-collapse">
              <!-- Search -->
              <div class="navbar-nav align-items-center">
                <div class="nav-item d-flex align-items-center">
                  <i class="bx bx-search fs-4 lh-0"></i>
                  <input
                    type="text"
                    class="form-control border-0 shadow-none"
                    placeholder="Search..."
                    aria-label="Search..."
                  />
                </div>
              </div>
              <!-- /Search -->
              <ul class="navbar-nav flex-row align-items-center ms-auto">
                <!-- Place this tag where you want the button to render. -->
                <li class="nav-item lh-1 me-3">
                  <a
                    class="github-button"
                    href="https://github.com/themeselection/sneat-html-admin-template-free"
                    data-icon="octicon-star"
                    data-size="large"
                    data-show-count="true"
                    aria-label="Star themeselection/sneat-html-admin-template-free on GitHub"
                    >Star</a
                  >
                </li>
                <!-- User -->
                <li class="nav-item navbar-dropdown dropdown-user dropdown">
                  <a class="nav-link dropdown-toggle hide-arrow" href="javascript:void(0);" data-bs-toggle="dropdown">
                    <div class="avatar avatar-online">
                      <img src="../dash/assets/img/avatars/1.png" alt class="w-px-40 h-auto rounded-circle" />
                    </div>
                  </a>
                  <ul class="dropdown-menu dropdown-menu-end">
                    <li>
                      <a class="dropdown-item" href="#">
                        <div class="d-flex">
                          <div class="flex-shrink-0 me-3">
                            <div class="avatar avatar-online">
                              <img src="../dash/assets/img/avatars/1.png" alt class="w-px-40 h-auto rounded-circle" />
                            </div>
                          </div>
                          <div class="flex-grow-1">
                            <span class="fw-semibold d-block">John Doe</span>
                            <small class="text-muted">Admin</small>
                          </div>
                        </div>
                      </a>
                    </li>
                    <li>
                      <div class="dropdown-divider"></div>
                    </li>
                    <li>
                      <a class="dropdown-item" href="#">
                        <i class="bx bx-user me-2"></i>
                        <span class="align-middle">My Profile</span>
                      </a>
                    </li>
                    <li>
                      <a class="dropdown-item" href="#">
                        <i class="bx bx-cog me-2"></i>
                        <span class="align-middle">Settings</span>
                      </a>
                    </li>
                    <li>
                      <a class="dropdown-item" href="#">
                        <span class="d-flex align-items-center align-middle">
                          <i class="flex-shrink-0 bx bx-credit-card me-2"></i>
                          <span class="flex-grow-1 align-middle">Billing</span>
                          <span class="flex-shrink-0 badge badge-center rounded-pill bg-danger w-px-20 h-px-20">4</span>
                        </span>
                      </a>
                    </li>
                    <li>
                      <div class="dropdown-divider"></div>
                    </li>
                    <li>
                      <a class="dropdown-item" href="auth-login-basic.html">
                        <i class="bx bx-power-off me-2"></i>
                        <span class="align-middle">Log Out</span>
                      </a>
                    </li>
                  </ul>
                </li>
                <!--/ User -->
              </ul>
            </div>
          </nav>
          <!-- / Navbar -->
            <!-- Content wrapper -->
            <style>
                #loop-text {
                    height: 30px;
                    overflow: hidden;
                }

                    #loop-text ul {
                        height: 100%;
                        width: 100%;
                        -webkit-animation: scroll 8s infinite;
                    }

                    #loop-text li {
                        line-height: 30px;
                        height: 30px;
                    }

                @@keyframes scroll {
                    0% {
                        -webkit-transform: translateY(0px);
                        transform: translateY(0px);
                    }

                    20% {
                        -webkit-transform: translateY(0px);
                        transform: translateY(0px);
                    }

                    25% {
                        -webkit-transform: translateY(-30px);
                        transform: translateY(-30px);
                    }

                    45% {
                        -webkit-transform: translateY(-30px);
                        transform: translateY(-30px);
                    }

                    50% {
                        -webkit-transform: translateY(-60px);
                        transform: translateY(-60px);
                    }

                    70% {
                        -webkit-transform: translateY(-60px);
                        transform: translateY(-60px);
                    }

                    75% {
                        -webkit-transform: translateY(-90px);
                        transform: translateY(-90px);
                    }

                    95% {
                        -webkit-transform: translateY(-90px);
                        transform: translateY(-90px);
                    }

                    100% {
                        -webkit-transform: translateY(-120px);
                        transform: translateY(-120px);
                    }
                }
            </style>
            <div class="content-wrapper">
                <!-- Content  BUTTONLAR -->

                <div class="container-xxl flex-grow-1 container-p-y">
                    

                    <div class="row">
                        <div class="col-md-12">
                            <ul class="nav nav-pills flex-column flex-md-row mb-3">
                                <li class="nav-item">
                                    <a class="nav-link active" href=/add_std><i class="bx bx-user me-1"></i>Öğrenci Ekle</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link " href=/add_academic><i class="bx bx-user me-1"></i>Öğretim Görevlisi Ekle</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href=/add_councilor><i class="bx bx-user me-1"></i>Kurul Üyesi Ekle</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href=/add_dpthead><i class="bx bx-user me-1"></i>Bölüm Sorumlusu Ekle</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link " href=/diger><i class="bx bx-user me-1"></i>Diğer</a>
                                </li>

                            </ul>
                            <div class="card mb-4">
                                <h5 class="card-header">Çoklu Öğrenci Ekle</h5>


                                <div class="card-body">
                                    <form id="formAccountSettings" method="POST" onsubmit="return false" style="text-align:center">
                                        <div style="align-content">
                                                <div class="button-wrapper">
                                                    <input accept=".csv" class="form-control" type="file" id="formFile">
                                                    <br>
                                                    <p style="color:red;" class="form-label">*YÜKLENECEK DOSYA .CSV UZANTILI OLMALIDIR!*</p>
                                                    <p style="color:red;" class="form-label">*CSV DOSYANIZDA İSİM, SOYİSİM, E-MAİL VE NUMARA OLDUĞUNDAN EMİN OLUN*</p>
                                                </div>
                                        </div>
                                    </form>
                                </div>
                            </div>   <!-- ILK DIV BITTI -->


                            <div class="card mb-4">
                                <!-- ALTTAKI DIV -->
                                <h5 class="card-header">Tek Öğrenci Ekle</h5>
                                <div class="card-body">
                                    <form id="formAccountSettings" method="POST" onsubmit="return false">
                                        <div class="row">


                                            <div class="mb-3 col-md-6">
                                                <label for="name" class="form-label">Adı</label>
                                                <input class="form-control" type="text" name="name" id="name" placeholder="Öğrencinin adını giriniz" />
                                            </div>


                                            <div class="mb-3 col-md-6">
                                                <label for="lastName" class="form-label">Soyadı</label>
                                                <input class="form-control" type="text" name="lastName" id="lastName" placeholder="Öğrencinin soyadını giriniz" />


                                            </div>

                                            <div class="mb-3 col-md-6">
                                                <label for="email" class="form-label">E-mail</label>
                                                <input placholder="E-mail" class="form-control"
                                                       type="text"
                                                       id="email"
                                                       name="email"
                                                       placeholder="Öğrencinin E-Mail adresini yazınız" />

                                            </div>
                                            <div class="mb-3 col-md-6">
                                                <label class="form-label" for="Number">Numarası</label>
                                                <div class="input-group input-group-merge">
                                                    <input type="number"
                                                           name="phoneNumber"
                                                           class="form-control"
                                                           placeholder="Öğrencinin numarasını yazınız" />
                                                </div>

                                            </div>

                                            <!-- KAYDET BUTTON -->
                                            <div class="mt-2">
                                                <button type="submit" class="btn btn-primary me-2">Kaydet</button>

                                            </div>


                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- / Content -->


                <br /><br />

            </div>  <!-- ALTAKKI DIV BITIYOR -->



        </div>
    </div>
    <div class="layout-overlay layout-menu-toggle"></div>
</div>
 

@code {
    void OnSingleCompleted(UploadInfo fileinfo)

    {

        if (fileinfo.File.State == UploadState.Success && fileinfo.File.Type == ".csv")
        {
            var result = fileinfo.File.GetResponse<ResponseModel>();
            fileinfo.File.Url = result.url;
        }

    }


    async Task OnSingleCompleted(InputFileChangeEventArgs e)
    { 
        try
        {
            var buffer = new byte[500000];
            foreach (var file in e.GetMultipleFiles(e.FileCount))
            {
                using var stream = file.OpenReadStream(maxAllowedSize: long.MaxValue);
                while (true)
                {
                    var read = await stream.ReadAsync(buffer);
                    if (read == 0)
                        break;
                }
                await InvokeAsync(StateHasChanged);
            }
            string x = "";
            foreach(var item in buffer)
            {
                if(item!=0)
                {
                    x += (char)item;
                }
            }
            string[] arr = await Task<string[]>.Run(() =>
            {
                return x.Replace("\r\n", "**78541**").Split("**78541**");
            });
            var a = x;
        }
        catch (Exception ex)
        {
            await InvokeAsync(StateHasChanged);
        }
    }




    public class ResponseModel
    {
        public string name { get; set; }

        public string status { get; set; }

        public string url { get; set; }

        public string thumbUrl { get; set; }
    }
}
